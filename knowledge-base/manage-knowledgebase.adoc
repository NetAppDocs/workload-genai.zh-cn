---
sidebar: sidebar 
permalink: knowledge-base/manage-knowledgebase.html 
keywords: ai, chatbot, managing, knowledge base 
summary: 创建知识库后、您可以查看知识库详细信息、修改知识库、集成其他数据源或删除知识库。 
---
= 管理GenAI知识库
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
创建知识库后、您可以查看知识库详细信息、修改知识库、集成其他数据源或删除知识库。



== 查看有关知识库的信息

您可以查看有关知识库和集成的数据源设置的信息。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 选择要查看的知识库。
+
如果已定义、则当前正在使用的对话启动器将显示在右窗格中。

. 要查看知识库详细信息，请选择，然后选择 image:icon-action.png["选项按钮"] *管理知识库*。
+
此页面显示已发布状态、数据源的嵌入状态、嵌入模式、所有嵌入数据源的列表等。

+
如果要进行任何更改，可使用*Actions*菜单管理知识库。





== 编辑知识库

您可以通过更改某些设置来更新知识库、也可以添加或删除数据源。

每次在知识库中添加、修改或删除数据源时、都必须同步数据源、以便将其重新编制到知识库索引。同步是增量的、因此Amazon Bonrock仅处理FSx for ONTAP卷中自上次同步以来添加、修改或删除的对象。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 从"Knowledge Bases"清单页面中、选择要更新的知识库。
. 选择 image:icon-action.png["选项按钮"] 并选择*管理知识库*。
+
此页面显示已发布状态、数据源的嵌入状态、嵌入模式、所有嵌入数据源的列表等。

. 选择*操作*菜单，然后选择*编辑知识库*。
. 在编辑知识库页面中，您可以更改知识库名称、描述、嵌入模型、聊天模型、功能启用，选择是自动还是手动创建对话启动器，以及包含知识库的卷使用的快照策略。
+
如果您使用"手动"模式启动对话、您也可以在此处更改启动对话的内容。

+

NOTE: 每个知识库扫描(包括嵌入)都将产生成本。如果在创建知识库后启用了数据防护、则会再次扫描知识库并产生成本。同样、如果您更改聊天模式、GenAI将重新扫描关联的数据源(产生成本)。

. 完成更改后选择*保存*。




== 使用快照保护知识库

您可以通过创建和还原知识库卷的快照来保护知识库数据。您可以随时从快照还原以还原到先前版本的知识库。

与备份相比、快照速度更快、存储效率更高、并支持您使用不同的保护策略来保护每个知识库。快照可能会很有用的一些情形包括：

* 意外数据丢失或损坏
* 从知识文库中输入的错误数据中恢复
* 测试不同的数据源或分块策略、并在测试完成后快速还原




=== 为知识库卷创建快照

您可以通过手动创建知识库卷的快照来保存知识库的状态。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 从"Knowledge Bases"清单页面中、选择要保护的知识库。
. 选择 image:icon-action.png["选项按钮"] 并选择*管理知识库*。
+
此页面显示已发布状态、数据源的嵌入状态、嵌入模式、所有嵌入数据源的列表等。

. 选择*操作*菜单，然后选择*快照>创建新快照*。
. (可选)选择*Define Snapshot name*并为快照输入自定义名称。
+
定义自定义名称可以帮助您更好地确定快照的内容、以便将来需要还原快照。

. 选择 * 创建 * 。
+
创建知识库快照。





=== 还原知识库卷的快照

您可以随时还原知识库卷的手动快照或计划快照。


NOTE: 如果存储在卷上的数据库已损坏或被删除、则无法使用生成型AI工作负载UI还原快照。解决方法是、您可以在托管此卷的ONTAP集群上使用还原此快照 https://docs.netapp.com/us-en/ontap-cli/volume-snapshot-restore.html["ONTAP 命令行界面"^]。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 从"Knowledge Bases"清单页面中、选择要还原的知识库。
. 选择 image:icon-action.png["选项按钮"] 并选择*管理知识库*。
+
此页面显示已发布状态、数据源的嵌入状态、嵌入模式、所有嵌入数据源的列表等。

. 选择*Actions*菜单，然后选择*Snapshot > Restore Snap照*。
+
此时将显示快照选择对话框、您可以在此对话框中查看为此知识库创建的快照列表。

. (可选)如果希望在恢复快照后继续执行计划的和当前正在运行的数据源扫描，请取消选择*恢复快照后暂停运行和计划扫描*选项。
+
默认情况下、此选项处于启用状态、以确保在知识库处于部分还原状态时不会进行扫描、或者扫描不会使用旧数据更新新还原的知识库。

. 从列表中选择要还原的快照。
. 选择 * 还原 * 。




=== 克隆知识库

您可以从知识库快照创建新的知识库。如果原始知识库已损坏或丢失、则此功能非常有用。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 从"Knowledge Bases"清单页面中、选择要还原的知识库。
. 选择 image:icon-action.png["选项按钮"] 并选择*管理知识库*。
+
此页面显示已发布状态、数据源的嵌入状态、嵌入模式、所有嵌入数据源的列表等。

. 选择*操作*菜单，然后选择*快照>克隆知识库*。
+
此时将显示克隆对话框。

. 或者，如果希望在克隆快照后继续执行计划的和当前正在运行的数据源扫描，请取消选择*Pause running and Scheduled scans after克隆快照*选项。
+
默认情况下、此选项处于启用状态、以确保在知识库处于部分还原状态时不会进行扫描、或者扫描不会使用旧数据更新新还原的知识库。

. 从列表中选择要克隆的快照。
. 选择 * 继续 * 。
. 输入新知识库的名称。
. 为新知识库选择文件系统SVM和卷名称。
. 选择 * 克隆 * 。




== 向知识库添加其他数据源

您可以在知识库中嵌入其他数据源、以使用其他组织数据填充该知识库。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 从"Knowledge Bases"清单页面中、选择要添加数据源的知识库。
. 选择，然后选择 image:icon-action.png["选项按钮"] *添加数据源*。
. 选择要添加的数据源类型：
+
** 添加 FSx for ONTAP 文件系统（使用现有 FSx for ONTAP 卷中的文件）
** 添加文件系统（使用来自通用 SMB 或 NFS 共享的文件）




[role="tabbed-block"]
====
.添加 FSx for ONTAP 文件系统
--
. *选择文件系统*：选择数据源文件所在的FSx for ONTAP文件系统，然后选择*下一步*。
. *选择卷*：选择数据源文件所在的卷，然后选择*下一步*。
+
选择使用SMB协议存储的文件时、您需要输入Active Directory信息、其中包括域、IP地址、用户名和密码。

. *选择数据源*：根据文件的保存位置选择数据源位置。该卷可以是整个卷，也可以是卷中的特定文件夹或子文件夹，然后选择*Next*。
. *配置*：配置数据源如何从文件中获取信息，以及它包含在扫描中的文件：
+
** *定义数据源*：在*Chunking string*部分中，定义在数据源与知识库集成时，GenAI引擎如何将数据源内容拆分成块。您可以选择以下策略之一：
+
*** *多句拆分*：将数据源中的信息组织为句子定义的区块。您可以选择每个区块包含多少个句子(最多100个)。
*** *基于重叠的区块*：将数据源中的信息组织为字符定义的区块，这些区块可以重叠相邻区块。您可以选择每个区块的字符大小、以及每个区块与相邻区块重叠的程度。您可以将区块大小配置为50到3000个字符、并将重叠百分比配置为1到99%。
+

NOTE: 选择较高的重叠百分比会显著增加存储需求、但检索准确性只会稍有提高。



** *文件过滤*：配置扫描中包含的文件：
+
*** 在*文件类型支持*部分，选择包括所有类型的文件，或选择要包含在数据源扫描中的单个文件类型。
+
如果您包含图像或 PDF 文件， NetApp Workload Factory for GenAI 会解析图像中的文本（包括 PDF 文档中的图像），这会产生更高的成本。

+
如果包含图像中的文本数据、则在将扫描的文本数据从您的环境发送到AWS时、GenAI无法屏蔽图像中的个人身份信息(个人身份信息、(PI))。但是、一旦存储数据、所有的数据都会在GenAI数据库中屏蔽。

+

NOTE: 您选择将图像文件包括在扫描中与知识库聊天模式相关。如果扫描中包含图像文件、则聊天模式必须支持图像。如果在此处选择了图像文件类型、则无法将知识库切换到不支持图像文件的聊天模式。

*** 在*文件修改时间过滤器*部分，选择根据修改时间启用或禁用包含文件。如果启用了修改时间筛选、请从列表中选择一个日期范围。
+

NOTE: 如果您包含基于修改日期范围的文件、则只要不满足日期范围(这些文件在您指定的日期范围内未被修改)、这些文件就会从定期扫描中排除、并且数据源不会包含这些文件。





. 在*权限感知*部分(仅当您选择的数据源位于使用SMB协议的卷上时才可用)中、您可以启用或禁用权限感知响应：
+
** *已启用*：访问此知识库的聊天机器人用户只会从他们有权访问的数据源获得查询响应。
** *已禁用*：聊天机器人用户将使用所有集成数据源的内容接收响应。


. 选择*Add*将此数据源添加到您的知识库中。


--
.添加通用 NFS 文件系统
--
. *选择文件系统*：输入数据源文件所在的文件系统主机的 IP 地址或 FQDN，选择网络共享的 NFS 协议，然后选择*下一步*。
. *选择数据源*：根据文件的保存位置选择数据源位置。该卷可以是整个卷，也可以是卷中的特定文件夹或子文件夹，然后选择*Next*。
+

NOTE: 在某些情况下，您可能需要手动输入 NFS 导出名称，然后选择“检索目录”以显示可用目录。您可以选择整个导出，或仅选择导出中的特定文件夹。

. *配置*：配置数据源如何从文件中获取信息，以及它包含在扫描中的文件：
+
** *定义数据源*：在*Chunking string*部分中，定义在数据源与知识库集成时，GenAI引擎如何将数据源内容拆分成块。您可以选择以下策略之一：
+
*** *多句拆分*：将数据源中的信息组织为句子定义的区块。您可以选择每个区块包含多少个句子(最多100个)。
*** *基于重叠的区块*：将数据源中的信息组织为字符定义的区块，这些区块可以重叠相邻区块。您可以选择每个区块的字符大小、以及每个区块与相邻区块重叠的程度。您可以将区块大小配置为50到3000个字符、并将重叠百分比配置为1到99%。
+

NOTE: 选择较高的重叠百分比会显著增加存储需求、但检索准确性只会稍有提高。



** *文件过滤*：配置扫描中包含的文件：
+
*** 在*文件类型支持*部分，选择包括所有类型的文件，或选择要包含在数据源扫描中的单个文件类型。
+
如果您包含图像或 PDF 文件， NetApp Workload Factory for GenAI 会解析图像中的文本（包括 PDF 文档中的图像），这会产生更高的成本。

+
如果包含图像中的文本数据、则在将扫描的文本数据从您的环境发送到AWS时、GenAI无法屏蔽图像中的个人身份信息(个人身份信息、(PI))。但是、一旦存储数据、所有的数据都会在GenAI数据库中屏蔽。

+

NOTE: 您选择将图像文件包括在扫描中与知识库聊天模式相关。如果扫描中包含图像文件、则聊天模式必须支持图像。如果在此处选择了图像文件类型、则无法将知识库切换到不支持图像文件的聊天模式。

*** 在*文件修改时间过滤器*部分，选择根据修改时间启用或禁用包含文件。如果启用了修改时间筛选、请从列表中选择一个日期范围。
+

NOTE: 如果您包含基于修改日期范围的文件、则只要不满足日期范围(这些文件在您指定的日期范围内未被修改)、这些文件就会从定期扫描中排除、并且数据源不会包含这些文件。





. 选择*添加数据源*将此数据源添加到您的知识库。


--
.添加通用 SMB 文件系统
--
. *选择文件系统*：
+
.. 输入数据源文件所在的文件系统主机的 IP 地址或 FQDN。
.. 为网络共享选择 SMB 协议。
.. 输入 Active Directory 信息，包括域、IP 地址、用户名和密码。
.. 选择 * 下一步 * 。


. *选择数据源*：根据文件的保存位置选择数据源位置。该卷可以是整个卷，也可以是卷中的特定文件夹或子文件夹，然后选择*Next*。
+

NOTE: 在某些情况下，您可能需要手动输入 SMB 共享名称，然后选择“检索目录”以显示可用目录。您可以选择整个共享，或仅选择共享中的特定文件夹。

. *配置*：配置数据源如何从文件中获取信息，以及它包含在扫描中的文件：
+
** *定义数据源*：在*Chunking string*部分中，定义在数据源与知识库集成时，GenAI引擎如何将数据源内容拆分成块。您可以选择以下策略之一：
+
*** *多句拆分*：将数据源中的信息组织为句子定义的区块。您可以选择每个区块包含多少个句子(最多100个)。
*** *基于重叠的区块*：将数据源中的信息组织为字符定义的区块，这些区块可以重叠相邻区块。您可以选择每个区块的字符大小、以及每个区块与相邻区块重叠的程度。您可以将区块大小配置为50到3000个字符、并将重叠百分比配置为1到99%。
+

NOTE: 选择较高的重叠百分比会显著增加存储需求、但检索准确性只会稍有提高。



** *权限感知*：启用或禁用权限感知响应：
+
*** *已启用*：访问此知识库的聊天机器人用户只会从他们有权访问的数据源获得查询响应。
*** *已禁用*：聊天机器人用户将使用所有集成数据源的内容接收响应。


** *文件过滤*：配置扫描中包含的文件：
+
*** 在*文件类型支持*部分，选择包括所有类型的文件，或选择要包含在数据源扫描中的单个文件类型。
+
如果您包含图像或 PDF 文件， NetApp Workload Factory for GenAI 会解析图像中的文本（包括 PDF 文档中的图像），这会产生更高的成本。

+
如果包含图像中的文本数据、则在将扫描的文本数据从您的环境发送到AWS时、GenAI无法屏蔽图像中的个人身份信息(个人身份信息、(PI))。但是、一旦存储数据、所有的数据都会在GenAI数据库中屏蔽。

+

NOTE: 您选择将图像文件包括在扫描中与知识库聊天模式相关。如果扫描中包含图像文件、则聊天模式必须支持图像。如果在此处选择了图像文件类型、则无法将知识库切换到不支持图像文件的聊天模式。

*** 在*文件修改时间过滤器*部分，选择根据修改时间启用或禁用包含文件。如果启用了修改时间筛选、请从列表中选择一个日期范围。
+

NOTE: 如果您包含基于修改日期范围的文件、则只要不满足日期范围(这些文件在您指定的日期范围内未被修改)、这些文件就会从定期扫描中排除、并且数据源不会包含这些文件。





. 选择*添加数据源*将此数据源添加到您的知识库。


--
====
.结果
数据源已集成到您的知识库中。



== 将数据源与知识库同步

数据源每天自动与相关知识库同步一次、以便任何数据源更改都反映在聊天机器人中。如果您对任何数据源进行了更改、并且希望立即同步数据、则可以执行按需同步。

同步是增量的、因此Amazon Bonck仅处理数据源中自上次同步以来添加、修改或删除的对象。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 从"Knowledge Bases"清单页面中、选择要同步的知识库。
. 选择 image:icon-action.png["选项按钮"] 并选择*管理知识库*。
. 选择*Actions*菜单，然后选择*Scan Now (立即扫描)*。
+
您将看到一条消息、指示正在扫描数据源、扫描完成后、您将看到最后一条消息。



.结果
知识库与所连接的数据源同步、任何活动的聊天机器人都将开始使用您的数据源中的最新信息。



=== 暂停或恢复计划的同步

如果要暂停或恢复数据源的下次同步(扫描)、您可以随时执行此操作。如果要更改数据源、并且不希望在更改窗口期间进行同步、则可能需要暂停下一次计划同步。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 从知识库和连接器菜单中，选择要暂停或恢复扫描的知识库。
. 选择 image:icon-action.png["选项按钮"] 并选择*管理知识库*。
. 选择*Actions*菜单，然后选择*Scan > Pause Scheduled scan-*或*Scan > Resume Scheduled scan-*。
+
您将看到一条消息、指出下一个计划扫描已暂停或恢复。





== 在创建知识库之前评估聊天模式

您可以在创建知识库之前评估可用的基础聊天模式、以便了解哪种模式最适合您的实施。由于型号支持因AWS地区而异、请参见 https://docs.aws.amazon.com/bedrock/latest/userguide/models-regions.html["此AWS文档页面"^] 以验证您可以在计划部署知识库的地区使用哪些型号。


NOTE: 只有在未创建任何知识库时(即"知识库"清单页面中不存在任何知识库时)、此功能才可用。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 在知识库清单页面中、您将在页面右侧看到选择聊天机器人聊天模式的选项。
. 从列表中选择聊天模式、然后在提示区域输入一组问题、以查看聊天机器人的响应方式。
. 尝试多种模式、了解哪种模式最适合您的实施。


.结果
创建知识库时、请使用聊天模式。



== 取消发布知识库

在发布知识库以便与聊天机器人应用程序集成后、如果要禁止聊天机器人应用程序访问知识库、可以取消发布。

取消发布知识库会停止任何聊天应用程序的工作。已禁用可访问知识库的唯一API端点。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 从"Knowledge Bases"清单页面中、选择要取消发布的知识库。
. 选择 image:icon-action.png["选项按钮"] 并选择*管理知识库*。
+
此页面显示已发布状态、数据源的嵌入状态、嵌入模式以及所有嵌入数据源的列表。

. 选择*Actions*菜单，然后选择*Unpub*。


.结果
此知识库已禁用、无法再由聊天机器人应用程序访问。



== 删除知识库

如果您不再需要知识库，您可以将其删除。当您删除知识库时，它将从 Workload Factory 中删除，并且包含该知识库的卷也将被删除。任何使用知识库的应用程序或聊天机器人都将停止工作。删除知识库是不可逆的。

删除知识库时、您还应解除知识库与关联的任何代理的关联、以完全删除与知识库关联的所有资源。

.步骤
. 使用以下方式之一登录 Workload Factorylink:https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 在AI Workloads (AI工作负载)磁贴中、选择*部署和管理*。
. 从"Knowledge Bases"清单页面中、选择要删除的知识库。
. 选择 image:icon-action.png["选项按钮"] 并选择*管理知识库*。
. 选择*操作*菜单，然后选择*删除知识库*。
. 在“删除知识库”对话框中，确认要将其删除，然后选择*Delete*。


.结果
知识库已从 Workload Factory 中删除，并且其关联卷也已被删除。
